//APCS1 Leonard Wang 1stperiod
package textExcel;
public class FormulaCell extends RealCell{
	private String value = "";
	public FormulaCell(String input){
		value = input;
		//stores string in parent class
		getDoubleValue();
	}
	public double getDoubleValue(){
		String noParenthesis = value.substring(2, value.length() - 2);
		String[] changeValue = noParenthesis.split(" ");
//		if(changeValue.length == 1){
//			return Double.parseDouble(changeValue[0]);
//		} else if(changeValue[0].toUpperCase().equals("SUM") || changeValue[0].toUpperCase().equals("AVG")){
//			//get the begginning cell and ending cell
//			String beginning = changeValue[1].toUpperCase().substring(0, changeValue[1].indexOf('-'));
//			String ending = changeValue[1].toUpperCase().substring(changeValue[1].indexOf('-') + 1);
//			while(!beginning.equals(ending)){
//				SpreadsheetLocation test = new SpreadsheetLocation(beginning);
//				Cell tests = loc.getCell(test);
//			}
//		}
		double finalValue = Double.parseDouble(changeValue[0]);
		//( 5.4 * 3.5 / -1.4 + 27.4 - 11.182 ) 
		//increments by 2 and tests for signs to correctly 
		for(int i = 2; i < changeValue.length; i+=2){
			if(changeValue[i-1].equals("+")){
				finalValue += Double.parseDouble(changeValue[i]);
			} else if(changeValue[i-1].equals("*")){
				finalValue *= Double.parseDouble(changeValue[i]);
			} else if(changeValue[i-1].equals("/")){
				finalValue /= Double.parseDouble(changeValue[i]);
			} else{
				finalValue -= Double.parseDouble(changeValue[i]);
			}
		}
		setRealCell(finalValue + "");
		return finalValue;
	}
	public String fullCellText(){
		return value;
	}
}
