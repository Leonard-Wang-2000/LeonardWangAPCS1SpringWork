//APCS1 Leonard Wang 1stperiod
package textExcel;
public class FormulaCell extends RealCell{
	private String value = "";
	public FormulaCell(String input){
		value = input;
		//stores string in parent class
		getDoubleValue();
	}
	public double getDoubleValue(){
		String[] changeValue = value.split(" ");
		double finalValue = 0.0;
		//( 4 + 3 )
		for(int i = 2; i < changeValue.length; i+=2){
			if(changeValue[i].equals("+")){
				finalValue += Double.parseDouble(changeValue[i-1]);
				finalValue += Double.parseDouble(changeValue[i+1]);
			} else if(changeValue[i+1].equals("*")){
				finalValue *= Double.parseDouble(changeValue[i-1]);
				finalValue *= Double.parseDouble(changeValue[i+1]);
			} else if(changeValue[i+1].equals("/")){
				finalValue /= Double.parseDouble(changeValue[i-1]);
				finalValue /= Double.parseDouble(changeValue[i+1]);
			} else{
				finalValue -= Double.parseDouble(changeValue[i-1]);
				finalValue -= Double.parseDouble(changeValue[i+1]);
			}
		}
		setRealCell(value + "");
		return finalValue;
	}
	public String abbreviatedCellText(){
		return value;
	}
	public String fullCellText(){
		return value;
	}
}
